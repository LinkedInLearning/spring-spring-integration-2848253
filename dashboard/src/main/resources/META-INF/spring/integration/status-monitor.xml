<?xml version="1.0" encoding="UTF-8"?>
<beans:beans xmlns="http://www.springframework.org/schema/integration"
             xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
             xmlns:beans="http://www.springframework.org/schema/beans"
             xmlns:int="http://www.springframework.org/schema/integration"
             xsi:schemaLocation="http://www.springframework.org/schema/beans
			   https://www.springframework.org/schema/beans/spring-beans.xsd
			   http://www.springframework.org/schema/integration
			   https://www.springframework.org/schema/integration/spring-integration.xsd" >

    <!-- Configure Spring Integration Tech Support message flow here -->

    <!-- DirectChannel example (Subscribable) -->
    <int:channel id="apiInputChannel" />

    <!-- Transformer example (JSON to Object) -->
    <int:json-to-object-transformer input-channel="apiInputChannel"
                                    output-channel="statusMonitorChannel"
                                    type="com.lil.springintegration.util.AppSupportStatus" />

    <!-- PublishSubscribeChannel example (Subscribable) -->
    <int:publish-subscribe-channel id="statusMonitorChannel" />

    <!-- Challenge: Add a ServiceActivator to the message flow -->
    <!-- Hint: element name is 'service-activator' -->
    <!-- Hint: you will need three attributes: input-channel, ref, method/> -->
    <!-- Hint: See here for technical specifications on ServiceActivator -->
    <!-- https://docs.spring.io/spring-integration/reference/html/messaging-endpoints.html#service-activator -->

    <!-- Hint: This is the bean you should reference in your service-activator declaration -->
    <beans:bean id="accountCreditService" class="com.lil.springintegration.service.CustomerAccountService" />

    <!-- Filter example -->
    <int:filter input-channel="statusMonitorChannel"
                output-channel="updateNotificationQueueChannel"
                ref="updateNoticeSelector" />

    <beans:bean id="updateNoticeSelector" class="com.lil.springintegration.service.StatusMonitorService.ServiceMessageFilter" />

    <!-- QueueChannel examples (Pollable) -->
    <int:channel id="updateNotificationQueueChannel">
        <int:queue capacity="5" />
    </int:channel>

</beans:beans>

